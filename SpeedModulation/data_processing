

r = RatCatcher;

r.experimenter = 'Caitlin';
r.alphanumeric = 'A';
r.analysis = 'BandwidthEstimator';
r.localPath = '/Users/pranavnambiar/Desktop/CODE_FILES/...';

r.namespec = ('output-');

r.batchify();




tic;
load('BandwidthEstimator-Caitlin-A-*');
dataTable = r.gather();
dataStitch = r.stitch(dataTable);

[method, root] = r.extract(dataTable, 1, r.analysis);
histogram(dataTable);


stats = root.fit(dataTable);

b = BandwidthEstimator(root);
spikeTrain = getSpikeTrain(b.spikeTimes, b.timestamps);
plot(spikeTrain);
toc;

[estimate, kmax, loglikelihoods, bandwidths, CI, kcorr, correlation] = b.cvKernel;
kmax
kcorr
